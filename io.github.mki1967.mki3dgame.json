{
    "app-id": "io.github.mki1967.mki3dgame",
    "runtime": "org.freedesktop.Platform",
    "runtime-version": "18.08",
    "sdk": "org.freedesktop.Sdk",
    "sdk-extensions": [
        "org.freedesktop.Sdk.Extension.golang"
    ],
    "command": "mki3dgame",
    "finish-args": [
	"--share=ipc",
	"--socket=x11",
	"--socket=pulseaudio",
	"--share=network",
	"--device=dri",
	"--socket=wayland"
    ],
    "cleanup": [
	"/go",
	"/bin/scripts"
    ],
    "modules": [
	{
	    "name": "scripts",
	    "sources": [
		{
		    "type": "script",
		    "commands": [
			". /usr/lib/sdk/golang/enable.sh;  export GOPATH=/app/go"
		    ],
		    "dest-filename": "my_enable.sh"
		},
		{
		    "type": "script",
		    "commands": [
			". /app/bin/scripts/my_enable.sh; cd /app/go/src/$1; go build"
		    ],
		    "dest-filename": "build.sh"
		}
	    ],
	    "buildsystem": "simple",
	    "build-commands": [
		"mkdir -p /app/go/{src,pkg,bin} # make go workspace",
		"install -d /app/bin/scripts",
		"cp *.sh /app/bin/scripts/"
	    ]
	},
	{
	    "name": "mki3dgame",
	    "buildsystem": "simple",
	    "build-commands": [
		"cp -rpv go/* /app/go/",
		"/app/bin/scripts/build.sh github.com/mki1967/mki3dgame",
		"mv /app/go/src/github.com/mki1967/mki3dgame/mki3dgame /app/go/src/github.com/mki1967/mki3dgame/usr/games/mki3dgame.bin",
		"rm /app/go/src/github.com/mki1967/mki3dgame/usr/share/games/mki3dgame/assets # remove a symbolic link",
		"mv /app/go/src/github.com/mki1967/mki3dgame/assets /app/go/src/github.com/mki1967/mki3dgame/usr/share/games/mki3dgame/",
		"mv /app/go/src/github.com/mki1967/mki3dgame/usr/share /app/",
		"mv /app/go/src/github.com/mki1967/mki3dgame/usr/bin/* /app/bin/",
		"cd /app; ln -s bin games",
		"rm  /app/share/icons/hicolor/64x64/apps/io.github.mki1967.mki3dgame.png",
		"rm  /app/share/icons/hicolor/128x128/apps/io.github.mki1967.mki3dgame.png",
		"cp /app/share/games/mki3dgame/assets/icons/mkisg_icon_64x64.png  /app/share/icons/hicolor/64x64/apps/io.github.mki1967.mki3dgame.png",
		"cp /app/share/games/mki3dgame/assets/icons/mkisg_icon_128x128.png  /app/share/icons/hicolor/128x128/apps/io.github.mki1967.mki3dgame.png"
		
	    ],
	    "sources": [
		{
		    "type": "git",
		    "url": "https://github.com/mki1967/mki3dgame",
		    "commit" : "0ce2889514988fbeb49e51ab98ebeefc26d32a0f",
		    "dest": "go/src/github.com/mki1967/mki3dgame"
		},
		{
		    "type": "git",
		    "url": "https://github.com/go-gl/gl",
		    "commit" : "55b76b7df9d25d70b63e31a767f47158292b85d8",
		    "dest": "go/src/github.com/go-gl/gl"
		},
		{
		    "type": "git",
		    "url": "https://github.com/go-gl/glfw",
		    "commit" : "691ee1b84c51ae625ed1aafebc915d3db3d63d66",
		    "dest": "go/src/github.com/go-gl/glfw"
		},
		{
		    "type": "git",
		    "url": "https://github.com/go-gl/mathgl",
		    "commit" : "cdf14b6b8f8a4a1bfb003dd5119205c5f711d85a",
		    "dest": "go/src/github.com/go-gl/mathgl"
		},
		{
		    "type": "git",
		    "url": "https://github.com/mki1967/go-mki3d",
		    "commit" : "55197faecb010cc06cb3e158017b5527fd73a5f5",
		    "dest": "go/src/github.com/mki1967/go-mki3d"
		},
		{
		    "type": "git",
		    "url": "https://github.com/mki1967/go-skybox",
		    "commit" : "cf0150fa725a42f9e77527b5de91e18e5ef07606",
		    "dest": "go/src/github.com/mki1967/go-skybox"
		},
		{
		    "type": "git",
		    "url": "https://github.com/golang/image",
		    "commit" : "2a2258ff36e99cf9156acfc715e3f83d47d6f0fd",
		    "dest": "go/src/golang.org/x/image"
		}
	    ]
	}

    ]
}
